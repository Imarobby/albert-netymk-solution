<html>
	<head>
		<title>Client-Side Vertical Bar Charts</TITLE>
		<style type="text/css">
table#tblgraph {
	padding: 5px;
	background-color: #c0c0c0;
}

.XAxisLabel, .YAxisLabel {
	font: 0.7em sans-serif;
}

.BackgroundTr {
	background-color: #c0c0c0;
}

.txtXAxisLabel, .txtYAxisLabel {
	padding: 0;
	font: 0.7em sans-serif;
	color: blue;
}
		</style>
		<script type="text/javascript" src="jquery.js"></script>
		<script type="text/javascript">
				var graph;
				var barWidth = 40;
				// The upper limit.
				var yMax = 100;
				var yInterval = 10;
				var displayYAxisScale = true;
				var displaySeparator = false;
				var displayValue = true;
				var scale = 300;
				var txtYAxisLabel = 'Score';
				var txtXAxisLabel = 'Student';
				
				function GenerateChart() {
					HorX = new Array("Jan 06", "Feb 06", "Mar 06", "Apr 06", "May 06", "Jun 06", "Jul 06", "Aug 06", "Sep 06", "Oct 06", "Nov 06", "Dec 06", "Jan 07", "Feb 07", "Mar 07", "Apr 07", "May 07", "Jun 07", "Jul 07", "Aug 07", "Sep 07", "Oct 07", "Nov 07", "Dec 07");
					VerY = new Array();
					var colNum = HorX.length;
					for (i = 0; i < colNum; i++) {
						VerY[i] = parseInt(Math.random() * 100);
					}
					// Reset the Column Count to the length of Array WITH VALUES
					colNum = HorX.length;
				
					// Set the Desired Width of the window as per the no. of items
					graph = "";
					// Check whether to show Line Seperators or not
					if (displaySeparator == true) {
						graph += '<table id="tblgraph" align=center width=' + '"100%"' + ' cellpadding=2 cellspacing=2 border=0>';
					} else {
						graph += '<table id="tblgraph" align=center width=' + '"100%"' + " cellpadding=2 cellspacing=0 border=0>";
					}
				
					graph += "<tr bgcolor=#C0C0C0>";
				
					// YAxisLabel
					graph+='<td class="YAxisLabel" align=center valign=middle width=' + barWidth + ' style="writing-mode:tb-rl">';
					graph+='<span class="txtYAxisLabel">' + txtYAxisLabel + '</span></td>';
				
					// Write the Y Axis Scale
					if (displayYAxisScale == true) {
						graph+="<td align=center valign=bottom width=" + barWidth + ">";
						graph+= "<table cellpadding=0 cellspacing=0 border=1 width=100% valign=bottom>";
				
						yCellHeight = (yInterval * scale /yMax);
						for (i=parseInt(yMax/yInterval); i>0; i--) {
							graph+= '<tr><td align=center bgcolor=#505050 valign=top width=100% height=' + yCellHeight + '>';
							graph+= "<font face=arial size='-2' color=white>" + (i*yInterval) + "</font>"
								graph+= "</td></tr>"
						}
						graph+="</table>";
						graph+="</td>";
					}
				
					// Write the graph
					for (i = 0; i < HorX.length; i++) {
						h = parseInt(VerY[i]*scale / yMax );
				
						graph+="<td align=center valign=bottom width=" + barWidth + ">";
						if (displayValue == true) {
							graph+= "<font face=arial size='-2'>" + VerY[i] + "</font>"
						}
						graph+= "<br><div style='writing-mode:tb-rl; background-color:blue; width:" + (barWidth-5) + "; height:" + h + ";' />"
						graph+="</td>";
					}
				
					graph += "</tr>";
				
					graph += '<tr bgcolor="#505050">';
					// Write the X Axis graphs
					graph += '<td class="BackgroundTr" align=center></td>';
					// Add the blank Cell for Y Axis Scale
					if (displayYAxisScale == true) {
						graph += '<td class="BackgroundTr" align=center bordor=1 > </td>';
					}
				
					for (i=0; i < HorX.length; i++) {
						graph += '<td align=center><span class="XAxisLabel">' + HorX[i] + "</span></td>";
					}
					graph += "</tr>";
				
					graph += '<tr><td align=center colspan="' + parseInt(colNum + 2) + '"><span class="txtXAxisLabel">' + txtXAxisLabel + '</span></td></tr>';
					graph += "</table></body></html>";
				
					$("#divGraph").html(graph);
				}
				$(function() {
						GenerateChart();
				});
		</script>

	</head>
	<body> 
		<div id="divGraph" style="border: solid;"></div>
	</body>
</html>
